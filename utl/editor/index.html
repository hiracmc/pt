<!DOCTYPE html>
<html>
<head>
  <title>editor</title>
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <style>
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      overflow: hidden;
    }
    #container {
      width: 100%;
      height: 100%;
    }
  </style>
</head>
<body>
  <div id="container"></div>

  <script src="https://cdn.jsdelivr.net/npm/monaco-editor@latest/min/vs/loader.js"></script>
  <script>
    require.config({ paths: { 'vs': 'https://cdn.jsdelivr.net/npm/monaco-editor@latest/min/vs' }});

    require(['vs/editor/editor.main'], async function() {
      // 読み込むライブラリのURLリスト
      const libraryUrls = [
        // 前回から追加済みのライブラリ
        { url: 'https://jaylydev.github.io/scriptapi-docs/assets/meta/math/latest/minecraft-math.d.ts', path: 'minecraft-math.d.ts' },
        { url: 'https://jaylydev.github.io/scriptapi-docs/assets/meta/vanilla-data/latest/index.js', path: 'vanilla-data.js' },
        
        // 今回新しく追加するライブラリ
        { url: 'https://unpkg.com/@minecraft/server@latest/index.d.ts', path: 'npm:@minecraft/server/index.d.ts' },
        { url: 'https://unpkg.com/@minecraft/server-ui@latest/index.d.ts', path: 'npm:@minecraft/server-ui/index.d.ts' }
      ];

      try {
        // 全てのライブラリファイルを並行して取得
        const fetchPromises = libraryUrls.map(lib => fetch(lib.url).then(res => res.text()));
        const contents = await Promise.all(fetchPromises);

        // 取得した内容をMonaco Editorの外部ライブラリとして追加
        contents.forEach((content, index) => {
          monaco.languages.typescript.javascriptDefaults.addExtraLib(
            content,
            libraryUrls[index].path // エディタ内での仮想ファイルパス
          );
        });
        
        console.log('すべてのライブラリが正常に読み込まれました。');

        // エディタを初期化
        monaco.editor.create(document.getElementById('container'), {
          value: [
            '// @minecraft/server と @minecraft/server-ui の予測変換が有効です。',
            '// "world." や "form." と入力して試してみてください。',
            '',
            'import { world, system } from "@minecraft/server";',
            'import { ActionFormData } from "@minecraft/server-ui";',
            '',
            'world.sendMessage("Hello from Monaco Editor!");',
            '',
            'const form = new ActionFormData();',
            'form.title("My First Form");',
            'form.body("This is the body text.");',
            'form.button("Button 1");',
            '',
            'system.run(() => {',
            '  // systemオブジェクトの補完も機能します',
            '});'
          ].join('\n'),
          language: 'javascript',
          theme: 'vs-dark'
        });

      } catch (error) {
        console.error('ライブラリの読み込みまたはエディタの初期化に失敗しました:', error);
        document.getElementById('container').innerText = 'エディタの読み込みに失敗しました。詳細はコンソールを確認してください。';
      }
    });
  </script>
</body>
</html>```

### 変更点のポイント

1.  **URLリストの拡張**: 読み込みたいライブラリの情報を `libraryUrls` 配列にまとめ、管理しやすくしました。
2.  **`addExtraLib` の仮想パス**: `@minecraft/server` のようなnpmパッケージの場合、エディタがモジュールとして正しく認識できるように、仮想ファイルパス（`path`）を `npm:@minecraft/server/index.d.ts` のように設定しています。これにより、コード内で `import` 文を書いた際に、対応する型定義をエディタが見つけやすくなります。
3.  **サンプルコードの更新**: エディタの初期コードを、新しく追加した `@minecraft/server` と `@minecraft/server-ui` のAPIを実際に使う例に書き換えました。これにより、ページを開いてすぐに予測変換が機能することを確認できます。
